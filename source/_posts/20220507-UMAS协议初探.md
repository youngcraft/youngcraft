---
title: 施耐德umas工控协议初探
date: 2022-05-07 08:42:53
tags:
categories:   
    - 工控协议
    - 逆向工程
---


# 施耐德工控协议 UMAS 协议初探


## 背景介绍

![施耐德公司logo](https://dss0.bdstatic.com/-0U0bnSm1A5BphGlnYG/tam-ogel/33cc8d9a4db4e02ae63d6f23ab7fd2b7_222_222.jpg
)

&emsp;&emsp;施耐德电气有限公司（Schneider Electric SA）是总部位于法国的全球化电气企业，全球能效管理和自动化领域的专家。 集团2016财年销售额为250亿欧元，在全球100多个国家拥有超过16万名员工。 1836年由施耐德兄弟建立。 它的总部位于法国吕埃。 施耐德电气的宗旨，是赋能所有人对能源和资源的最大化利用， 推动人类进步与可持续的共同发展。

&emsp;&emsp;施耐德电气的使命是成为用户实现高效和可持续发展的数字化伙伴。 施耐德电气致力于推动数字化转型，服务于家居、楼宇、数据中心、基础设施和工业市场。 通过集成世界领先的工艺和能源管理技术，从终端到云的互联互通产品、控制、软件和服务，贯穿业务全生命周期，实现整合的企业级管理。

&emsp;&emsp;施耐德UMAS协议是建立在UMAS协议之上的协议簇，主要利用0x5A（90）功能码进行设备操作、上传、下载、运行等等。其中，UMAS (Unified Messaging Application Services) 统一消息传递应用程序服务，它是用于交换应用程序数据的平台独立协议，通信数据使用标准的Modbus协议。Modbus是Modicon公司在1979年开发的基于消息结构的协议，最早是为Modicon公司的PLC中使用，后为施耐德电气公司所有。Modbus协议是现今使用的最早和应用最广泛的工业控制系统协议之一，主要是用于和现场控制器通信的应用层协议，共有三种工作模式：Modbus/ASCII，Modbus/RTU，和Modbus/TCP。Modbus协议标准是公开的，其众多功能码早已广为人知，在此不做赘述。但其标准文档中也提到了一些未公开、且为占用状态的功能码，90功能码（0x5A）即为其中一个，UMAS协议即为90功能码的Modbus。

## UMAS协议使用场景

&emsp;&emsp;主要解释UMAS协议使用情况，包括组态、上传下载、交互监控。

UMAS协议使用场景，施耐德组态软件中，对于PLC、DCS

## UMAS协议逆向方法

经典协议逆向方法，聚类或人工分析，

### 广义的协议逆向方法

### 本例子中协议逆向方法




## 零日漏洞使用与效果

### 拒绝服务漏洞

### 使用限制条件



##